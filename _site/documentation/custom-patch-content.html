<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="/docs-assets/ico/favicon.png">

    <title></title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">

    <!-- Custom styles for this template -->
    <link href="/custom/css/custom.css" rel="stylesheet">
    <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">

    <link href="http://vjs.zencdn.net/4.3/video-js.css" rel="stylesheet">
    <script src="http://vjs.zencdn.net/4.3/video.js"></script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>
    <!-- Static navbar -->
<header class="navbar navbar-default navbar-fixed-top navbar-custom" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="#"></a>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li> 
          <a href="/index.html"> 
            <i class="fa fa-home fa-lg"></i> 
          </a>
        </li>
        <li> 
          <a href="/gettingstarted.html">
            Overview
          </a>
        </li>
        <li class="active"> 
          <a href="/documentation/quickstart-osx.html">
            Documentation
          </a>
        </li>
        <li>
          <a href="https://github.com/SMSG-MAC-DEV/MacPatch">
            <i class="fa fa-github fa-lg"></i> 
          </a>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <!-- <li><a href="/about.html">About</a></li>
        <li><a href="/contact.html">Contact</a></li> -->
      </ul>
    </div><!--/.nav-collapse -->
  </div>
</header>


    <!-- Page content -->
    <div class="container-fluid" id="sidenav">
  <br><br>
  <div class="container-fluid">
    <div class="row">
      <div class="col-xs-2 col-xs-offset-1">

        <!-- Sidebar navbar for Documentation pages -->
<ul class="nav nav-sidebar">
  <li>
    <a href="/documentation/quickstart-osx.html">Quick Start - OSX</a></li>
  <li>
    <a href="/documentation/quickstart-linux.html">Quick Start - Linux</a></li>
  <li>
    <a href="/documentation/building-the-client.html">Building The Client</a></li>
  <li>
    <a href="/documentation/custom-patch-content.html">Custom Patch Content</a></li>
  <li>
    <a href="/documentation/install-distribution-server.html">Install Distribution Server</a></li>
</ul>


      </div>
      <div class="col-xs-7">

          <div class="container-fluid" id="content">

    <h1>MacPatch - Custom Patch Content</h1>

    <p><strong>Version 1.0 for MacPatch v2.5.x</strong></p>

    <p>MacPatch custom patch content is pretty simple to create. All content is created via the new content wizard. Keep in mind that there are only 4 required attributes which are required to create a patch. The 4 attributes are <strong>Patch Name, Patch Version, Patch Group ID, Patch Package</strong>.</p>

    <h3>Create New Patch</h3>

    <p>Creating a new patch is broken down in to 4 steps. In this example we will be creating a patch for Firefox.</p>

    <h5>Step 1</h5>

    <p><img src="images/Patch-Step1.png" alt="" /></p>

    <p><strong>Patch Name, and Patch Version </strong>are required fields. By default a new patch has it's patch state set to "Create". A patch will not show as needed to a client until it's state is at least set to "QA".</p>

    <h5>Step 2</h5>

    <p><img src="images/Patch-Step2.png" alt="" /></p>

    <p>While none of the fields are required, adding patch detection criteria is highly recommended. In this example we have added two detection queries. The first one looks to see if the <strong>/Applications/Firefox.app</strong> exists. The second query looks to see if Firefox version is less than 30.0.0.</p>

    <p>For a patch to become required all patch detection criteria queries need to return <em>True</em>. If any return false a patch is not needed.</p>

    <p><a href="#cheatSheet">Query Language Cheat Sheet</a></p>

    <h5>Step 3</h5>

    <p><img src="images/Patch-Step3.png" alt="" /></p>

    <p><strong>Patch Group ID, and Patch Package </strong>are required fields.</p>

    <p>In this example it's important to note that the "Patch Group ID" is in the form Reverse URL and similar to Bundle ID. While anything can be used as a "Patch Group ID", bundle id's are suggested.</p>

    <p>When uploading a patch a *.pkg.zip file is required at this time.</p>

    <h5>Step 4</h5>

    <p><img src="images/Patch-Step4.png" alt="" /></p>

    <p>Here you can add pre &amp; post requisite packages. Also, once the patch is created you will need to make it active. This can only be done once the initial patch has been created.</p>

    <h3>Patch Criteria Language - Cheat Sheet <a name="cheatSheet"></a></h3>

    <table class="table table-bordered table-striped">
        <tr>
            <th>Base Criteria</th>
            <th>Description</th>
        </tr>
        <tr>
            <td>BundleID</td>
            <td>
                <table class="table table-bordered table-striped">
                    <tr>
                        <th>Query</th>
                        <th>Value</th>
                        <th>Query Result</th>
                        <th>Example Syntax</th>
                    </tr>
                    <tr>
                        <td>Exists</td>
                        <td>BundleID Value</td>
                        <td>True/False</td>
                        <td>Exists@com.adobe.Reader@True</td>
                    </tr>
                    <tr>
                        <td>Version</td>
                        <td>BundleID Value</td>
                        <td>Version;(EQ,LT,LTE,GT,GTE,NEQ)</td>
                        <td>Version@com.adobe.Reader@9.3.0;LT</td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td>File</td>
            <td>
                <table class="table table-bordered table-striped">
                    <tr>
                        <th>Query</th>
                        <th>Value</th>
                        <th>Query Result</th>
                        <th>Example Syntax</th>
                    </tr>
                    <tr>
                        <td>Exists</td>
                        <td>File Path</td>
                        <td>True/False</td>
                        <td>Exists@/Applications/Firefox.app@True</td>
                    </tr>
                    <tr>
                        <td>Date</td>
                        <td>File Path</td>
                        <td>True/False</td>
                        <td>Date@/Applications/Firefox.app@2010-03-22 12:00:00;LT</td>
                    </tr>
                    <tr>
                        <td>Hash</td>
                        <td>File Path</td>
                        <td>MD5 Hash;True/False</td>
                        <td>Hash@/Applications/Firefox.app@123432dsh2362h3h;TRUE</td>
                    </tr>
                    <tr>
                        <td>Version</td>
                        <td>File Path</td>
                        <td>Version;(EQ,LT,LTE,GT,GTE,NEQ)</td>
                        <td>Version@/Applications/Firefox.app@3.5.7;LT</td>
                    </tr>
                </table>
            </td>
            <tr>
                <td>Script</td>
                <td>
                    <table class="table table-bordered table-striped">
                        <tr>
                            <th>Query</th>
                            <th>Value</th>
                            <th>Query Result</th>
                            <th>Example Syntax</th>
                            <th>Notes</th>
                        </tr>
                        <tr>
                            <td>Script</td>
                            <td>Script Text</td>
                            <td>True</td>
                            <td>#!/bin/sh ...</td>
                            <td>If a @ is used it must be escaped with @</td>
                        </tr>
                    </table>
                </td>
            </tr>
        </tr>
    </table>


    <h4>Testing Patch Content</h4>

    <p>To test patch content you will need to edit the client settings those clients deemed as QA clients. This is done by creating a new patch group with the "QA" type and editing the clients config plist.</p>

    <p>Change PatchGroup</p>

    <pre><code>defaults write /Library/Preferences/gov.llnl.mpagent.plist PatchGroup RecommendedPatchesQA
    </code></pre>

    <p>Allow QA Patches to be installed</p>

    <pre><code>defaults write /Library/Preferences/gov.llnl.mpagent.plist PatchState All
    </code></pre>
</div>
        
      </div>
    </div>
  </div>
</div> <!-- /container -->

    <!-- Page footer -->
    <footer>
      <div class="row">
        <div class="col-sm-10 col-sm-offset-1">
          <p>MacPatch is available under the GNU GPLv2 license. See the <a href="https://github.com/SMSG-MAC-DEV/MacPatch/blob/master/LICENSE">LICENSE</a> file for more info.</p>
        </div>
      </div>
    </footer>
    
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/custom/js/custom.js" type="text/javascript" ></script>
    <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
  </body>
</html>
