<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="/docs-assets/ico/favicon.png">

    <title></title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">

    <!-- Custom styles for this template -->
    <link href="/custom/css/custom.css" rel="stylesheet">
    <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">

    <link href="http://vjs.zencdn.net/4.3/video-js.css" rel="stylesheet">
    <script src="http://vjs.zencdn.net/4.3/video.js"></script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>
    <!-- Static navbar -->
<header class="navbar navbar-default navbar-fixed-top navbar-custom" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="#"></a>
    </div>
    <div class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li> 
          <a href="/index.html"> 
            <i class="fa fa-home fa-lg"></i> 
          </a>
        </li>
        <li> 
          <a href="/gettingstarted.html">
            Overview
          </a>
        </li>
        <li class="active"> 
          <a href="/documentation/quickstart-osx.html">
            Documentation
          </a>
        </li>
        <li>
          <a href="https://github.com/SMSG-MAC-DEV/MacPatch">
            <i class="fa fa-github fa-lg"></i> 
          </a>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <!-- <li><a href="/about.html">About</a></li>
        <li><a href="/contact.html">Contact</a></li> -->
      </ul>
    </div><!--/.nav-collapse -->
  </div>
</header>


    <!-- Page content -->
    <div class="container-fluid" id="sidenav">
  <br><br>
  <div class="container-fluid">
    <div class="row">
      <div class="col-xs-2 col-xs-offset-1">

        <!-- Sidebar navbar for Documentation pages -->
<ul class="nav nav-sidebar">
  <li>
    <a href="/documentation/quickstart-osx.html">Quick Start - OSX</a></li>
  <li>
    <a href="/documentation/quickstart-linux.html">Quick Start - Linux</a></li>
  <li>
    <a href="/documentation/building-the-client.html">Building The Client</a></li>
  <li>
    <a href="/documentation/custom-patch-content.html">Custom Patch Content</a></li>
  <li class="active">
    <a href="/documentation/install-distribution-server.html">Install Distribution Server</a></li>
<!--   <li>
    <a href="/documentation/documentation.html">More</a></li> -->
</ul>


      </div>
      <div class="col-xs-7">

          <div class="container-fluid" id="content">
	<h1>MacPatch - Install Distribution Server(s)</h1>

	<p>When the first server ("Master") is compiled and built it will create a file called "MacPatch_Server.zip" in /Library/MacPatch. This zip file is a complete copy of the master server build in a unconfigured state. Simply copy the "MacPatch_Server.zip" to your new distribution server.</p>

	<h4>Mac OS X Requirements</h4>

	<p>Java JDK needs to be installed.</p>

	<h4>Linux Requirements</h4>

	<h5>APT</h5>

	<pre><code>sudo apt-get update
sudo apt-get install git
sudo apt-get install build-essential
sudo apt-get install openjdk-7-jdk
sudo apt-get install zip
sudo apt-get install libssl-dev
sudo apt-get install libxml2-dev
sudo apt-get install python-pip
sudo apt-get install python-mysql.connector 
	</code></pre>

	<h5>YUM</h5>

	<pre><code>sudo yum install gcc-c++
sudo yum install openssl-devel
sudo java-1.7.0-openjdk-devel
sudo yum install libxml2-devel
sudo yum install bzip2
sudo yum install bzip2-libs
sudo yum install bzip2-devel
sudo yum install python-pip
sudo yum install mysql-connector-python
	</code></pre>

	<h5>Python</h5>

	<pre><code>pip install requests
pip install python-crontab
	</code></pre>

	<h2>Configure Server</h2>

	<h5>Distribution Server Setup &amp; Config</h5>

	<pre><code>mkdir -p /Library/MacPatch
cp {FROM_PATH}/MacPatch_Server.zip /Library/MacPatch
cd /Library/MacPatch
unzip ./MacPatch_Server.zip
mv ./MacPatch_Server ./Server
	</code></pre>

	<h5>Run Setup Scripts</h5>

	<pre><code>cd /Library/MacPatch/Server 
./conf/scripts/Setup/DataBaseLDAPSetup.sh
./conf/scripts/Setup/WebServicesSetup.sh
	</code></pre>

	<p>This distribution server is now configured and running. The last step is to edit the Apache virtual host balancer to include the new distribution server.</p>

	<h5>Configure "Master" MacPatch server</h5>

	<p>Using your favorite editor edit the following file "/Library/MacPatch/Server/Apache2/conf/extra/httpd-vhosts.conf". You will want to edit the Virtual host "*:2600" (<VirtualHost *:2600>).</p>

	<p>Find and edit the lines:</p>

	<pre><code>#WslBalanceStart
BalancerMember http://localhost:3601 route=localhost-site1 loadfactor=50
#WslBalanceStop  
	</code></pre>

	<p>Add the line below the first "<strong>BalancerMember</strong>"</p>

	<pre><code>BalancerMember http://[YOUR_SERVER_NAME_OR_IP]:3601 route=[YOUR_SERVER_NAME]-site1 loadfactor=50
	</code></pre>

	<p>Add the server(s) via the Admin console</p>

	<p>Login to the MacPatch admin console with a admin account and go to "Admin->Server->MacPatch Server" and add the new server.</p>

	<h5>Start the MacPatch services</h5>

	<pre><code>/Library/MacPatch/Server/conf/scripts/Setup/StartServices.py --load All
	</code></pre>

</div>
        
      </div>
    </div>
  </div>
</div> <!-- /container -->

    <!-- Page footer -->
    <!-- <footer> -->
<!--       <div class="row">
        <div class="col-sm-10 col-sm-offset-1">
          <p>MacPatch is available under the GNU GPLv2 license. See the <a href="https://github.com/SMSG-MAC-DEV/MacPatch/blob/master/LICENSE">LICENSE</a> file for more info.</p>
        </div>
      </div> -->
      
      <div class="footer">
        <div class="container">
          <p>MacPatch is available under the GNU GPLv2 license. See the <a href="https://github.com/SMSG-MAC-DEV/MacPatch/blob/master/LICENSE">LICENSE</a> file for more info.</p>
        </div>
      </div>
    
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/custom/js/custom.js" type="text/javascript" ></script>
    <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
  </body>
<!--     <nav class="navbar navbar-inverse navbar-default navbar-static-bottom" role="navigation">
      <div class="container">
        <p class="navbar-text">MacPatch is available under the GNU GPLv2 license. See the <a href="https://github.com/SMSG-MAC-DEV/MacPatch/blob/master/LICENSE" class="navbar-link">LICENSE</a> file for more info.</p>
      </div>
    </nav> -->
</html>
